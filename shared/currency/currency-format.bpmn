<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:spiffworkflow="http://spiffworkflow.org/bpmn/schema/1.0/core" id="Definitions_96f6665" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="3.0.0-dev">
  <bpmn:process id="Proccess_fsb94qw" isExecutable="true">
    <bpmn:startEvent id="StartEvent_1">
      <bpmn:outgoing>Flow_1gd0615</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="Flow_1gd0615" sourceRef="StartEvent_1" targetRef="Activity_05iptty" />
    <bpmn:callActivity id="Activity_05iptty" name="Call Shared: Build Enum List from AWS" calledElement="Shared_Build_Enum_List_from_AWS">
      <bpmn:extensionElements>
        <spiffworkflow:preScript>whichSubject = "Currency"
addNew = False</spiffworkflow:preScript>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1gd0615</bpmn:incoming>
      <bpmn:outgoing>Flow_0oh3r7q</bpmn:outgoing>
    </bpmn:callActivity>
    <bpmn:endEvent id="Event_0brhprl">
      <bpmn:incoming>Flow_0ljzxco</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_0oh3r7q" sourceRef="Activity_05iptty" targetRef="Activity_0j2b9gv" />
    <bpmn:sequenceFlow id="Flow_18zj1kx" sourceRef="Activity_0j2b9gv" targetRef="Activity_1gp7tds" />
    <bpmn:userTask id="Activity_0j2b9gv" name="Select Currency">
      <bpmn:extensionElements>
        <spiffworkflow:properties>
          <spiffworkflow:property name="formJsonSchemaFilename" value="which-currency_JSONSchema.json" />
          <spiffworkflow:property name="formUiSchemaFilename" value="which-currency_UISchema.json" />
        </spiffworkflow:properties>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0oh3r7q</bpmn:incoming>
      <bpmn:outgoing>Flow_18zj1kx</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_174qezd" sourceRef="Activity_1gp7tds" targetRef="Activity_1q2cms5" />
    <bpmn:businessRuleTask id="Activity_1gp7tds" name="Get Currency Formatting Info">
      <bpmn:extensionElements>
        <spiffworkflow:calledDecisionId>Currency_Format</spiffworkflow:calledDecisionId>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_18zj1kx</bpmn:incoming>
      <bpmn:outgoing>Flow_174qezd</bpmn:outgoing>
    </bpmn:businessRuleTask>
    <bpmn:sequenceFlow id="Flow_1jyj2rk" sourceRef="Activity_1q2cms5" targetRef="Activity_0045py7" />
    <bpmn:scriptTask id="Activity_1q2cms5" name="Add Currency Format" scriptFormat="python">
      <bpmn:incoming>Flow_174qezd</bpmn:incoming>
      <bpmn:outgoing>Flow_1jyj2rk</bpmn:outgoing>
      <bpmn:script># Add zeros if less than two decimal digits
curAmount_str = "{:0,.2f}".format(curAmount)

# Add Currency Symbol
if curSymbolLocation == "Left"
   curAmount_str = curSymbol + " " * curSymbolSpaces + curAmount_str
elif curSymbolLocation == "Right"
   curAmount_str = curAmount_str + " " * curSymbolSpaces + curSymbol

# Add Currency Code
curAmount_str = curAmount_str + " " + curCode

# Check if separaters need to be swapped
if curThousandsSeparator == ".":
    main_currency, fractional_currency = currency.split(".")[0], currency.split(".")[1]
    new_main_currency = main_currency.replace(",", ".")
    currency = new_main_currency + fractional_separator + fractional_currency




"curSymbol": "$",
  "addNew": false,
  "curAmount": 2000,
  "curAmount_str": "2,000.00",
  "curCode": "AUD",
  "curFractionalSeparator": ".",
  "curName": "Australian Dollar",
  "curSymbolLocation": "Left",
  "curSymbolSpaces": 1,
  "curThousandsSeparator": ",",</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="Flow_0ljzxco" sourceRef="Activity_0045py7" targetRef="Event_0brhprl" />
    <bpmn:manualTask id="Activity_0045py7" name="Display Currency Format">
      <bpmn:extensionElements>
        <spiffworkflow:instructionsForEndUser>{{ curAmount_str }}</spiffworkflow:instructionsForEndUser>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1jyj2rk</bpmn:incoming>
      <bpmn:outgoing>Flow_0ljzxco</bpmn:outgoing>
    </bpmn:manualTask>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Proccess_fsb94qw">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="179" y="159" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0jkj7ru_di" bpmnElement="Activity_05iptty">
        <dc:Bounds x="270" y="137" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0brhprl_di" bpmnElement="Event_0brhprl">
        <dc:Bounds x="1112" y="159" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_145za7d_di" bpmnElement="Activity_0j2b9gv">
        <dc:Bounds x="440" y="137" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0z2f649_di" bpmnElement="Activity_1gp7tds">
        <dc:Bounds x="610" y="137" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_14tui7g_di" bpmnElement="Activity_1q2cms5">
        <dc:Bounds x="770" y="137" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0bc9xkn_di" bpmnElement="Activity_0045py7">
        <dc:Bounds x="940" y="137" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1gd0615_di" bpmnElement="Flow_1gd0615">
        <di:waypoint x="215" y="177" />
        <di:waypoint x="270" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0oh3r7q_di" bpmnElement="Flow_0oh3r7q">
        <di:waypoint x="370" y="177" />
        <di:waypoint x="440" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_18zj1kx_di" bpmnElement="Flow_18zj1kx">
        <di:waypoint x="540" y="177" />
        <di:waypoint x="610" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_174qezd_di" bpmnElement="Flow_174qezd">
        <di:waypoint x="710" y="177" />
        <di:waypoint x="770" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1jyj2rk_di" bpmnElement="Flow_1jyj2rk">
        <di:waypoint x="870" y="177" />
        <di:waypoint x="940" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ljzxco_di" bpmnElement="Flow_0ljzxco">
        <di:waypoint x="1040" y="177" />
        <di:waypoint x="1112" y="177" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
